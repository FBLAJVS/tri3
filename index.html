<!DOCTYPE html>
<html>
<head>
<style>
body {
    margin: 0;
    overflow: hidden;
    background-color: #000;
}
canvas {
    display: block;
    margin: 0;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    image-rendering: pixelated; /* To prevent blurring on scaling */
    image-rendering: crisp-edges;
    -ms-interpolation-mode: nearest-neighbor;
    width: 800px;
    height: 600px;
}
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const tileSize = 32;
    const tilesetURL = "https://opengameart.org/sites/default/files/LPC_1_15_tiled_0.png";
    let tileset;
    let mapData = [];

    // Map dimensions
    const mapCols = 25;
    const mapRows = 19;

    // Camera position
    let cameraX = 0;
    let cameraY = 0;

    // Player
    let player = {
        x: 10,
        y: 10,
        width: 32,
        height: 32
    };

    // Load tileset image
    function loadTileset() {
        tileset = new Image();
        tileset.onload = function() {
            console.log("Tileset loaded successfully.");
            generateMap();
            gameLoop();
        };
        tileset.onerror = function() {
            console.error("Failed to load tileset.");
        };
        tileset.src = tilesetURL;
    }

    // Generate a simple random map
    function generateMap() {
        for (let row = 0; row < mapRows; row++) {
            mapData[row] = [];
            for (let col = 0; col < mapCols; col++) {
                // Randomly choose between a couple of tile indices (e.g., grass and dirt)
                if (Math.random() > 0.8) {
                    mapData[row][col] = 1; // Dirt tile
                } else {
                    mapData[row][col] = 0; // Grass tile
                }
            }
        }
        console.log("Map data generated.");
    }

    // Draw the map
    function drawMap() {
        for (let row = 0; row < mapRows; row++) {
            for (let col = 0; col < mapCols; col++) {
                const tileIndex = mapData[row][col];
                const sourceX = (tileIndex % (tileset.width / tileSize)) * tileSize;
                const sourceY = Math.floor(tileIndex / (tileset.width / tileSize)) * tileSize;

                ctx.drawImage(
                    tileset,
                    sourceX,
                    sourceY,
                    tileSize,
                    tileSize,
                    col * tileSize - cameraX,
                    row * tileSize - cameraY,
                    tileSize,
                    tileSize
                );
            }
        }
    }

    // Draw the player
    function drawPlayer() {
        // Simple red rectangle for the player
        ctx.fillStyle = 'red';
        ctx.fillRect(player.x - cameraX, player.y - cameraY, player.width, player.height);
    }

    // Update game logic (movement, etc.)
    function update() {
        // Move camera to follow the player
        cameraX = player.x - (canvas.width / 2) + (player.width / 2);
        cameraY = player.y - (canvas.height / 2) + (player.height / 2);
    }

    // Main game loop
    function gameLoop() {
        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Update and draw
        update();
        drawMap();
        drawPlayer();

        // Request next frame
        requestAnimationFrame(gameLoop);
    }

    // Handle user input
    window.addEventListener('keydown', (e) => {
        const speed = 5;
        switch (e.key) {
            case 'ArrowUp':
                player.y -= speed;
                break;
            case 'ArrowDown':
                player.y += speed;
                break;
            case 'ArrowLeft':
                player.x -= speed;
                break;
            case 'ArrowRight':
                player.x += speed;
                break;
        }
    });

    // Start the game
    loadTileset();
});
</script>
</body>
</html>
